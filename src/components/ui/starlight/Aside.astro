---
import { Icon } from 'astro-icon/components';

const asideVariants = ['note', 'tip', 'caution', 'danger'] as const;

// Map aside types to Lucide icons matching Amina's icon system
const icons = {
  note: 'lucide:info',
  tip: 'lucide:lightbulb',
  caution: 'lucide:alert-triangle',
  danger: 'lucide:alert-octagon',
} as const;

// Default titles in Amina's voice
const defaultTitles = {
  note: 'note',
  tip: 'pro tip',
  caution: 'heads up',
  danger: 'danger zone',
} as const;

interface Props {
  type?: (typeof asideVariants)[number];
  title?: string;
}

let { type = 'note', title } = Astro.props;

// Validate type
if (!asideVariants.includes(type)) {
  type = 'note';
}

// Use default title if not provided
if (!title) {
  title = defaultTitles[type];
}
---

<aside aria-label={title} class={`amina-aside amina-aside--${type}`}>
  <p class="amina-aside__title" aria-hidden="true">
    <Icon
      name={icons[type]}
      class="amina-aside__icon"
      width="1.333em"
      height="1.333em"
    />
    <span>{title}</span>
  </p>
  <div class="amina-aside__content">
    <slot />
  </div>
</aside>

<style>
  .amina-aside {
    padding: 1rem 1.25rem;
    border-radius: var(--radius-md);
    border-left: 4px solid var(--aside-border);
    background: var(--aside-bg);
    margin: 1rem 0;
    transition:
      box-shadow 0.2s ease,
      transform 0.2s ease;
  }

  .amina-aside:hover {
    box-shadow: 0 0 20px var(--aside-glow);
    transform: translateX(2px);
  }

  /* Note - Electric Blue (info/secondary) */
  .amina-aside--note {
    --aside-border: var(--electric-blue, #1e90ff);
    --aside-bg: rgba(30, 144, 255, 0.08);
    --aside-accent: var(--electric-blue, #1e90ff);
    --aside-glow: rgba(30, 144, 255, 0.2);
  }

  /* Tip - Discord Green (success) */
  .amina-aside--tip {
    --aside-border: var(--discord-green, #57f287);
    --aside-bg: rgba(87, 242, 135, 0.08);
    --aside-accent: var(--discord-green, #57f287);
    --aside-glow: rgba(87, 242, 135, 0.2);
  }

  /* Caution - Imperial Gold (warning/achievements) */
  .amina-aside--caution {
    --aside-border: var(--economy-gold, #ffd700);
    --aside-bg: rgba(255, 215, 0, 0.08);
    --aside-accent: var(--economy-gold, #ffd700);
    --aside-glow: rgba(255, 215, 0, 0.2);
  }

  /* Danger - Blood Red (danger) */
  .amina-aside--danger {
    --aside-border: var(--blood-red, #8b0000);
    --aside-bg: rgba(139, 0, 0, 0.1);
    --aside-accent: var(--blood-red, #8b0000);
    --aside-glow: rgba(139, 0, 0, 0.25);
  }

  .amina-aside__title {
    display: flex;
    gap: 0.5rem;
    align-items: center;
    font-family: var(--font-heading, 'Rajdhani', sans-serif);
    font-size: var(--sl-text-h5, 0.9rem);
    font-weight: 700;
    line-height: var(--sl-line-height-headings, 1.2);
    color: var(--aside-accent);
    text-transform: lowercase;
    letter-spacing: 0.02em;
    margin: 0;
  }

  .amina-aside__icon {
    flex-shrink: 0;
    color: var(--aside-accent);
    filter: drop-shadow(0 0 4px var(--aside-glow));
  }

  .amina-aside__title + .amina-aside__content {
    margin-top: 0.5rem;
  }

  .amina-aside__content {
    font-family: var(--font-body, 'Inter', sans-serif);
    font-size: var(--sl-text-body, 1rem);
    line-height: 1.7;
    color: var(--sl-color-gray-2, #c9c9c9);
  }

  .amina-aside__content :global(a) {
    color: var(--aside-accent);
    text-decoration: underline;
    text-underline-offset: 2px;
    transition: color 0.2s ease;
  }

  .amina-aside__content :global(a:hover) {
    filter: brightness(1.2);
  }

  .amina-aside__content :global(code) {
    background: rgba(0, 0, 0, 0.3);
    padding: 0.15em 0.4em;
    border-radius: 4px;
    font-size: 0.9em;
  }

  .amina-aside__content :global(p) {
    margin: 0;
  }

  .amina-aside__content :global(p + p) {
    margin-top: 0.5rem;
  }
</style>
